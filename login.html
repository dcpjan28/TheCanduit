<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Canduit Login</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Share Tech Mono', monospace;
            background-color: #1a1a1a;
            color: #E0E0E0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
        }
        .container {
            background-color: #2b2b2b;
            padding: 2.5rem;
            border-radius: 1rem;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
            max-width: 400px;
            width: 90%;
            border: 2px solid #00FFD1;
            box-sizing: border-box;
        }
        .btn {
            background-color: #00FFD1;
            color: #1a1a1a;
            font-weight: bold;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: all 0.2s;
            cursor: pointer;
        }
        .btn:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }
        .btn:active {
            transform: translateY(0);
        }
        .input-field {
            width: 100%;
            padding: 0.75rem;
            margin-top: 0.5rem;
            border: 2px solid #6C757D;
            background-color: #1a1a1a;
            color: #E0E0E0;
            border-radius: 0.5rem;
        }
    </style>
</head>
<body class="antialiased">
    <div class="container text-center">
        <h1 class="text-4xl font-bold text-[#00FFD1] mb-6">THE CANDUIT</h1>
        <p class="text-gray-400 mb-8">Establish your connection to the grid.</p>
        
        <div id="auth-container">
            <!-- Login Form -->
            <div id="login-form">
                <h2 class="text-2xl font-bold mb-4">Log In</h2>
                <input type="email" id="login-email" placeholder="Email" class="input-field mb-4">
                <input type="password" id="login-password" placeholder="Password" class="input-field mb-6">
                <button id="login-button" class="btn w-full mb-4">Log In</button>
                <button id="show-signup" class="text-sm text-gray-400 hover:text-[#00FFD1] transition-colors">Don't have an account? Sign Up</button>
            </div>
            
            <!-- Signup Form -->
            <div id="signup-form" class="hidden">
                <h2 class="text-2xl font-bold mb-4">Sign Up</h2>
                <input type="email" id="signup-email" placeholder="Email" class="input-field mb-4">
                <input type="password" id="signup-password" placeholder="Password" class="input-field mb-6">
                <button id="signup-button" class="btn w-full mb-4">Sign Up</button>
                <button id="show-login" class="text-sm text-gray-400 hover:text-[#00FFD1] transition-colors">Already have an account? Log In</button>
            </div>
        </div>

        <div id="loading-spinner" class="hidden mt-6">
            <div class="loading-spinner mx-auto"></div>
        </div>

    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        
        // Provided Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDcuO4WKBIlQngOscjlHgvdZ51zb97716M",
            authDomain: "thecanduit.firebaseapp.com",
            projectId: "thecanduit",
            storageBucket: "thecanduit.firebasestorage.app",
            messagingSenderId: "730071923902",
            appId: "1:730071923902:web:7b76c0b1dacd01511772ef",
            measurementId: "G-BDMTVG5SFN"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        
        const loginForm = document.getElementById('login-form');
        const signupForm = document.getElementById('signup-form');
        const loginEmail = document.getElementById('login-email');
        const loginPassword = document.getElementById('login-password');
        const signupEmail = document.getElementById('signup-email');
        const signupPassword = document.getElementById('signup-password');
        const loginButton = document.getElementById('login-button');
        const signupButton = document.getElementById('signup-button');
        const showLoginButton = document.getElementById('show-login');
        const showSignupButton = document.getElementById('show-signup');
        const loadingSpinner = document.getElementById('loading-spinner');

        onAuthStateChanged(auth, (user) => {
            if (user) {
                // If a user is already logged in, redirect them to the main app.
                window.location.href = 'index.html';
            }
        });

        const showLoading = (show) => {
            loadingSpinner.classList.toggle('hidden', !show);
            loginButton.disabled = show;
            signupButton.disabled = show;
        };

        const handleLogin = async () => {
            const email = loginEmail.value;
            const password = loginPassword.value;
            showLoading(true);
            try {
                await signInWithEmailAndPassword(auth, email, password);
                window.location.href = 'index.html';
            } catch (error) {
                alert(`Login failed: ${error.message}`);
                showLoading(false);
            }
        };

        const handleSignup = async () => {
            const email = signupEmail.value;
            const password = signupPassword.value;
            showLoading(true);
            try {
                await createUserWithEmailAndPassword(auth, email, password);
                window.location.href = 'index.html';
            } catch (error) {
                alert(`Signup failed: ${error.message}`);
                showLoading(false);
            }
        };

        loginButton.addEventListener('click', handleLogin);
        signupButton.addEventListener('click', handleSignup);

        showSignupButton.addEventListener('click', () => {
            loginForm.classList.add('hidden');
            signupForm.classList.remove('hidden');
        });

        showLoginButton.addEventListener('click', () => {
            signupForm.classList.add('hidden');
            loginForm.classList.remove('hidden');
        });
    </script>
</body>
</html>
